<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="DISTRO_LINE">

	<resultMap id="DISTRO_LINE_RESULT" class="com.mpower.domain.model.paymentInfo.DistributionLine">
		<result property="id" column="DISTRO_LINE_ID" jdbcType="BIGINT" />
		<result property="amount" column="DISTRO_LINE_AMOUNT" jdbcType="DECIMAL" />
		<result property="percentage" column="DISTRO_LINE_PERCENTAGE" jdbcType="DECIMAL" />
		<result property="projectCode" column="DISTRO_LINE_PROJECT_CODE" jdbcType="VARCHAR" />
		<result property="motivationCode" column="DISTRO_LINE_MOTIVATION_CODE" jdbcType="VARCHAR" />
		<result property="other_motivationCode" column="DISTRO_LINE_OTHER_MOTIVATION" jdbcType="VARCHAR" />
		<result property="giftId" column="DISTRO_GIFT_ID" jdbcType="BIGINT" />
		<result property="commitmentId" column="DISTRO_COMMITMENT_ID" jdbcType="BIGINT" />
	</resultMap>

	<sql id="DISTRO_LINE_COLS_FRAGMENT">
		dl.DISTRO_LINE_ID, dl.AMOUNT as DISTRO_LINE_AMOUNT, dl.PERCENTAGE as DISTRO_LINE_PERCENTAGE,
		dl.PROJECT_CODE as DISTRO_LINE_PROJECT_CODE, dl.MOTIVATION_CODE as DISTRO_LINE_MOTIVATION_CODE, 
		dl.OTHER_MOTIVATION as DISTRO_LINE_OTHER_MOTIVATION, dl.GIFT_ID as DISTRO_GIFT_ID, dl.COMMITMENT_ID as DISTRO_COMMITMENT_ID
	</sql>
	
	<select id="SELECT_DISTRO_LINE_BY_ID" resultMap="DISTRO_LINE_RESULT" parameterClass="long">
		select 
		<include refid="DISTRO_LINE_COLS_FRAGMENT" />
		from DISTRO_LINE dl
		where dl.DISTRO_LINE_ID = #id#
	</select>

	<insert id="INSERT_DISTRO_LINE" parameterClass="com.mpower.domain.model.paymentInfo.DistributionLine">
		insert into DISTRO_LINE (AMOUNT, MOTIVATION_CODE, OTHER_MOTIVATION, PERCENTAGE, PROJECT_CODE, COMMITMENT_ID, GIFT_ID)
		values (#amount#, #motivationCode#, #other_motivationCode#, #percentage#, #projectCode#, #commitmentId#, #giftId#)
		<selectKey keyProperty="id" resultClass="long">
			SELECT LAST_INSERT_ID() AS value
		</selectKey>
	</insert>

	<update id="UPDATE_DISTRO_LINE" parameterClass="com.mpower.domain.model.paymentInfo.DistributionLine">
		update DISTRO_LINE
		set AMOUNT = #amount#,
		PERCENTAGE = #percentage#,
		PROJECT_CODE = #projectCode#,
		MOTIVATION_CODE = #motivationCode#,
		OTHER_MOTIVATION = #other_motivationCode#,
		COMMITMENT_ID = #commitmentId#,
		GIFT_ID = #giftId#
		where DISTRO_LINE_ID = #id#
	</update>

</sqlMap>