<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="PAYMENT_SOURCE">
	<resultMap id="PAYMENT_SOURCE_RESULT" class="com.mpower.domain.model.PaymentSource">
		<result property="id" column="PAYMENT_SOURCE_ID" jdbcType="BIGINT" />
		<result property="achAccountNumber" column="ACH_ACCOUNT_NUMBER" jdbcType="VARCHAR" />
		<result property="achHolderName" column="ACH_HOLDER_NAME" jdbcType="VARCHAR" />
		<result property="achRoutingNumber" column="ACH_ROUTING_NUMBER"	jdbcType="VARCHAR" />
		<result property="creditCardExpiration" column="CREDIT_CARD_EXPIRATION" jdbcType="TIMESTAMP" />
		<result property="creditCardHolderName" column="CREDIT_CARD_HOLDER_NAME" jdbcType="VARCHAR" />
		<result property="creditCardNumber" column="CREDIT_CARD_NUMBER" jdbcType="VARCHAR" />
		<result property="creditCardType" column="CREDIT_CARD_TYPE" jdbcType="VARCHAR" />
		<result property="inactive" column="INACTIVE" jdbcType="BIT" />
		<result property="paymentProfile" column="PAYMENT_PROFILE" jdbcType="VARCHAR" />
		<result property="paymentType" column="PAYMENT_TYPE" jdbcType="VARCHAR" />
		<result property="addressId" column="ADDRESS_ID" jdbcType="BIGINT" />
		<result property="personId" column="PERSON_ID" jdbcType="BIGINT" />
		<result property="phoneId" column="PHONE_ID" jdbcType="BIGINT" />
	</resultMap>

	<select id="SELECT_PAYMENT_SOURCE_BY_ID" resultMap="PAYMENT_SOURCE_RESULT" parameterClass="com.mpower.domain.model.PaymentSource">
		select PAYMENT_SOURCE_ID, ACH_ACCOUNT_NUMBER, ACH_HOLDER_NAME,
		ACH_ROUTING_NUMBER,
		CREDIT_CARD_EXPIRATION, CREDIT_CARD_HOLDER_NAME, CREDIT_CARD_NUMBER, CREDIT_CARD_TYPE,
		INACTIVE, PAYMENT_PROFILE, PAYMENT_TYPE, ADDRESS_ID, PERSON_ID,
		PHONE_ID
		from PAYMENT_SOURCE
		where PAYMENT_SOURCE_ID = #id#
	</select>

	<insert id="INSERT_PAYMENT_SOURCE" parameterClass="com.mpower.domain.model.PaymentSource">
		insert into PAYMENT_SOURCE (PAYMENT_SOURCE_ID, ACH_ACCOUNT_NUMBER,
		ACH_HOLDER_NAME,
		ACH_ROUTING_NUMBER, CREDIT_CARD_EXPIRATION, CREDIT_CARD_HOLDER_NAME, CREDIT_CARD_NUMBER,
		CREDIT_CARD_TYPE, INACTIVE, PAYMENT_PROFILE, PAYMENT_TYPE, ADDRESS_ID,
		PERSON_ID, PHONE_ID)
		values (#id#, #achAccountNumber#, #achHolderName#,
		#achRoutingNumber#, #creditCardExpiration#, #creditCardHolderName#,
		#creditCardNumber#, #creditCardType#, #inactive#,
		#paymentProfile#, #paymentType#, #addressId#, #personId#,
		#phoneId#)
        <selectKey keyProperty="id" resultClass="long">
            SELECT LAST_INSERT_ID() AS value
        </selectKey>
	</insert>

	<update id="UPDATE_PAYMENT_SOURCE" parameterClass="com.mpower.domain.model.PaymentSource">
		update PAYMENT_SOURCE
		set ACH_ACCOUNT_NUMBER = #achAccountNumber#,
		ACH_HOLDER_NAME = #achHolderName#,
		ACH_ROUTING_NUMBER = #achRoutingNumber#,
		CREDIT_CARD_EXPIRATION = #creditCardExpiration#,
		CREDIT_CARD_HOLDER_NAME = #creditCardHolderName#,
		CREDIT_CARD_NUMBER = #creditCardNumber#,
		CREDIT_CARD_TYPE = #creditCardType#,
		INACTIVE = #inactive#,
		PAYMENT_PROFILE = #paymentProfile#,
		PAYMENT_TYPE = #paymentType#,
		ADDRESS_ID = #addressId#,
		PERSON_ID = #personId#,
		PHONE_ID = #phoneId#
		where PAYMENT_SOURCE_ID = #id#
	</update>
	
</sqlMap>